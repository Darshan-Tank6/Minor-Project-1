<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Subject Details</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-gray-100 p-6">
    <div class="max-w-4xl mx-auto bg-white shadow-md rounded-lg p-6 space-y-6">
      <h1 class="text-2xl font-bold text-gray-800 border-b pb-2">
        Subject: <%= subject.name %>
      </h1>

      <% if (message) { %>
      <div class="bg-green-100 text-green-800 px-4 py-2 rounded">
        <%= message %>
      </div>
      <% } %>

      <p><span class="font-semibold">Type:</span> <%= subject.type %></p>
      <p>
        <span class="font-semibold">Class:</span> <%= subject.classId ?
        subject.classId.name : "N/A" %>
      </p>
      <p>
        <span class="font-semibold">Teaching Prof:</span> <%=
        subject.teachingProfId?.name || "None" %>
      </p>
      <p>
        <span class="font-semibold">Assistant Prof:</span> <%=
        subject.assistantProfId?.name || "None" %>
      </p>

      <div>
        <h2 class="text-lg font-semibold mt-4 border-b pb-1">Schedule</h2>
        <% if (subject.schedule?.length > 0) { %>
        <ul class="list-disc list-inside text-sm text-gray-700">
          <% subject.schedule.forEach(slot => { %>
          <li>
            <%= slot.day %> | <%= slot.startTime %> - <%= slot.endTime %> |
            Room: <%= slot.room %>
          </li>
          <% }) %>
        </ul>
        <% } else { %>
        <p class="text-sm text-gray-500">No schedule added.</p>
        <% } %>
      </div>

      <div>
        <h2 class="text-lg font-semibold mt-4 border-b pb-1">Chapters</h2>
        <% if (subject.chapters?.length > 0) { %>
        <ol
          class="list-decimal list-inside text-sm text-gray-800 space-y-1 mt-2"
        >
          <% subject.chapters.forEach(chap => { %>
          <li>
            <strong><%= chap.number %>. <%= chap.title %></strong>
            <% if (chap.topics?.length) { %>
            <ul class="ml-4 list-disc text-gray-600 text-sm">
              <% chap.topics.forEach(topic => { %>
              <li><%= topic %></li>
              <% }) %>
            </ul>
            <% } %>
          </li>
          <% }) %>
        </ol>
        <% } else { %>
        <p class="text-sm text-gray-500">No chapters added.</p>
        <% } %>
      </div>

      <div>
        <h2 class="text-lg font-semibold mt-6 border-b pb-1">
          Add New Chapter
        </h2>

        <form
          action="/admin/subjects/<%= subject._id %>/add-chapter"
          method="POST"
          class="space-y-4 mt-4"
        >
          <div>
            <label class="block text-sm font-medium">Chapter Number</label>
            <input
              type="number"
              name="number"
              required
              class="mt-1 block w-full border rounded px-3 py-2"
            />
          </div>

          <div>
            <label class="block text-sm font-medium">Chapter Title</label>
            <input
              type="text"
              name="title"
              required
              class="mt-1 block w-full border rounded px-3 py-2"
            />
          </div>

          <div>
            <label class="block text-sm font-medium"
              >Topics (comma-separated)</label
            >
            <input
              type="text"
              name="topics"
              class="mt-1 block w-full border rounded px-3 py-2"
            />
          </div>

          <button
            type="submit"
            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
          >
            Add Chapter
          </button>
        </form>
        <a
          href="/admin/subjects/under/class/<%= subject.classId._id %>"
          class="inline-block mt-6 text-gray-600 hover:underline"
          >‚Üê Back to subjects</a
        >
      </div>
    </div>
  </body>
</html>
